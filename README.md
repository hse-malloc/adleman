# Алгоритм Адельмана для дискретного логарифмирования

## Задача дискретного логарифмирования

Пусть заданы простое число *p* и вычет *a*, показатель которого по модулю *p* равен *q*, то есть *ord<sub>p</sub> a = q* и *q | p-1*.
Пусть задан вычет *b*, удовлетворяющий сравнению

*<p align="center"> a<sup>x</sup> ≡ b (mod p) </p>*

Задача определения вычета *x (mod q)* называется задачей вычисления дискретного логарифма элемента *b* по основанию *a*.

Принято использовать обозначение

*<p align="center"> x ≡ log<sub>a</sub> b (mod q) </p>*

Сравнение разрешимо только в том случае, когда вычет *b* принадлежит множеству *__A__* = {1, *a*, *a*<sup>2</sup>, ..., *a*<sup>*q*-1</sup>}

Свойства дискретного логарифма аналогичны свойствам обычного логарифма. Так, например, если верно, что

*<p align="center"> b ≡ b<sub>1</sub><sup>α<sub>1</sub></sup> \* ... \* b<sub>k</sub><sup>α<sub>k</sub></sup> (mod p) </p>*

то выполняется равенство

*<p align="center"> log<sub>a</sub> b ≡ α<sub>1</sub> log<sub>a</sub> b<sub>1</sub> + ... + α<sub>k</sub> log<sub>a</sub> b<sub>k</sub> (mod q) </p>*

Это свойство будет использоваться дальше в методе Адельмана.

## Метод Адельмана

### Базовая идея

Допустим, что у нас есть таблица простых чисел меньних B
*<p align="center"> __F__ = {p<sub>1</sub>, p<sub>2</sub>, ..., p<sub>s</sub>}, ∀p∈F p&lt;B </p>*
мы будем называть эту таблицу факторной базой.
И допустим, что мы знаем значения логарифмов всех элементов факторной базы по основанию *a*, то есть мы знаем величины 

*<p align="center">x<sub>1</sub> ≡ log<sub>a</sub> p<sub>1</sub> (mod q)</p>* 
*<p align="center">x<sub>2</sub> ≡ log<sub>a</sub> p<sub>2</sub> (mod q)</p>* 
*<p align="center">...</p>*
*<p align="center">x<sub>s</sub> ≡ log<sub>a</sub> p<sub>s</sub> (mod q)</p>*

Тогда, если мы нашли вычет *ξ* ∈ *F<sub>q</sub><sup>\*</sup>* такой, что 
*<p align="center"> b<sup>ξ</sup> ≡ p<sub>1</sub><sup>α<sub>1</sub></sup> \* ... \* p<sub>s</sub><sup>α<sub>s</sub></sup> (mod p), </p>*
где *α<sub>i</sub>* ≥ 0 и p<sub>i</sub> ∈ *__F__* ∀ *i*=0,...,*s*,
то воспользовавшись свойством логарифма, описанным выше, получаем искомое решение поставленной задачи
*<p align="center"> log<sub>a</sub> b ≡ ξ<sup>-1</sup> \* (α<sub>1</sub> log<sub>a</sub> p<sub>1</sub> + ... + α<sub>s</sub> log<sub>a</sub> p<sub>s</sub>) (mod q) </p>*

Таким образом метод Адельмана сводится к двум последовательным шагам:
1. Построение факторной базы и нахождение логарифмов элементов этой базы
2. Подсчёт значения искомого логарифма.
